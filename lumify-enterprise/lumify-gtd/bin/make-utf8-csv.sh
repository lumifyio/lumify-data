#!/bin/bash

# make-utf8-csv.sh
#
# Converts an Excel-generated UTF-16 tab-separated file to a UTF-8 spreadsheet.
# Input files should be generated by opening a target XLSX file and using "Save As"
# with the file type: "UTF-16 Unicode Text (.txt)"

INFILE=$1
OUTFILE=$2

if [ "$INFILE" == '' -o "$OUTFILE" == '' ]; then
	echo "Proper Usage: $0 <infile> <outfile>"
	exit 1
fi

UTF8_TSV=${INFILE}.utf8.tsv

iconv -f utf-16 -t utf-8 $INFILE > $UTF8_TSV
sed 's/	/,/g' $UTF8_TSV > $OUTFILE
rm $UTF8_TSV
